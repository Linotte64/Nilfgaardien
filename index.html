<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traducteur Fran√ßais ‚áÑ Nilfgaardien</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 1000px; margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px; padding: 30px;
        }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #667eea; font-size: 2.5em; margin-bottom: 10px; }
        
        .translator {
            background: #f8f9fa; border-radius: 15px; padding: 25px; margin-bottom: 30px;
        }
        .translation-row {
            display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center;
        }
        .translation-area label { font-weight: bold; margin-bottom: 10px; display: block; }
        .translation-area textarea { 
            width: 100%; height: 120px; border: 2px solid #e9ecef; 
            border-radius: 10px; padding: 15px; font-size: 16px; resize: none; 
        }
        .swap-btn { 
            background: linear-gradient(135deg, #ff6b6b, #feca57); 
            border: none; border-radius: 50%; width: 50px; height: 50px; 
            cursor: pointer; color: white; font-size: 20px;
        }
        
        .dictionary {
            background: #fff; border-radius: 15px; padding: 25px;
        }
        .dict-tabs { display: flex; margin-bottom: 20px; }
        .dict-tab { 
            padding: 10px 15px; background: #e9ecef; border: none; 
            cursor: pointer; margin-right: 5px; border-radius: 5px;
        }
        .dict-tab.active { background: #667eea; color: white; }
        
        .add-form { 
            background: #f1f3f4; padding: 15px; border-radius: 10px; margin-bottom: 15px; 
        }
        .add-form input, .add-form select { 
            margin: 5px; padding: 8px; border: 1px solid #ddd; border-radius: 5px; width: 140px;
        }
        .add-btn { 
            background: #28a745; color: white; border: none; 
            padding: 8px 15px; border-radius: 5px; cursor: pointer; margin: 5px;
        }
        
        .dict-list { max-height: 300px; overflow-y: auto; }
        .dict-entry { 
            background: #f8f9fa; margin: 5px 0; padding: 10px; 
            border-radius: 5px; border-left: 4px solid #667eea;
        }
        .remove-btn {
            float: right; background: #dc3545; color: white; border: none; 
            padding: 2px 8px; border-radius: 3px; cursor: pointer;
        }
        
        .analysis { 
            background: #e3f2fd; border-radius: 10px; padding: 15px; margin-top: 20px;
        }
        .word-analysis { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
        .word-tag { 
            background: white; border: 1px solid #ddd; border-radius: 8px; 
            padding: 8px 12px; font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üó°Ô∏è Traducteur Fran√ßais ‚áÑ Nilfgaardien üó°Ô∏è</h1>
            <p>Syst√®me de traduction avec conjugaisons automatiques</p>
        </div>
        
        <div class="translator">
            <h2>üîÑ Traduction</h2>
            <div class="translation-row">
                <div class="translation-area">
                    <label id="input-label">Fran√ßais</label>
                    <textarea id="input-text" placeholder="Tapez votre texte ici..."></textarea>
                </div>
                
                <button class="swap-btn" onclick="swapLanguages()">‚áÑ</button>
                
                <div class="translation-area">
                    <label id="output-label">Nilfgaardien</label>
                    <textarea id="output-text" placeholder="La traduction appara√Ætra ici..." readonly></textarea>
                </div>
            </div>
        </div>
        
        <div class="dictionary">
            <h2>üìö Dictionnaire</h2>
            
            <div class="dict-tabs">
                <button class="dict-tab active" onclick="showTab('verbs')">Verbes</button>
                <button class="dict-tab" onclick="showTab('nouns')">Noms</button>
                <button class="dict-tab" onclick="showTab('others')">Autres</button>
            </div>
            
            <!-- VERBES -->
            <div id="verbs-tab" class="tab-content">
                <div class="add-form">
                    <h4>Ajouter un verbe</h4>
                    <input type="text" id="verb-fr" placeholder="Fran√ßais (danser)">
                    <input type="text" id="verb-ng" placeholder="Nilfgaardien (addan)">
                                            <select id="verb-group">
                            <option value="1">1er groupe (-er)</option>
                            <option value="2">2√®me groupe (-ir)</option>
                            <option value="irregular">Irr√©gulier</option>
                        </select>
                    <button class="add-btn" onclick="addVerb()">Ajouter</button>
                </div>
                <div class="dict-list" id="verbs-list"></div>
            </div>
            
            <!-- NOMS -->
            <div id="nouns-tab" class="tab-content" style="display:none;">
                <div class="add-form">
                    <h4>Ajouter un nom</h4>
                    <input type="text" id="noun-fr" placeholder="Fran√ßais (b√™te)">
                    <input type="text" id="noun-ng" placeholder="Nilfgaardien (gorval)">
                    <select id="noun-gender-fr">
                        <option value="m">Masculin FR</option>
                        <option value="f">F√©minin FR</option>
                    </select>
                    <select id="noun-gender-ng">
                        <option value="m">Masculin NG</option>
                        <option value="f">F√©minin NG</option>
                    </select>
                    <button class="add-btn" onclick="addNoun()">Ajouter</button>
                </div>
                <div class="dict-list" id="nouns-list"></div>
            </div>
            
            <!-- AUTRES -->
            <div id="others-tab" class="tab-content" style="display:none;">
                <div class="add-form">
                    <h4>Ajouter un autre mot</h4>
                    <input type="text" id="other-fr" placeholder="Fran√ßais">
                    <input type="text" id="other-ng" placeholder="Nilfgaardien">
                    <select id="other-type">
                        <option value="article">Article</option>
                        <option value="pr√©position">Pr√©position</option>
                        <option value="conjonction">Conjonction</option>
                        <option value="adverbe">Adverbe</option>
                        <option value="pronom">Pronom</option>
                    </select>
                    <button class="add-btn" onclick="addOther()">Ajouter</button>
                </div>
                <div class="dict-list" id="others-list"></div>
            </div>
        </div>
        
        <div class="analysis" id="analysis" style="display:none;">
            <h3>üìã Analyse de la traduction</h3>
            <div class="word-analysis" id="word-analysis"></div>
            <div id="grammar-notes" style="margin-top: 15px;"></div>
        </div>
    </div>

    <script>
        // DICTIONNAIRE
        let dict = {
            verbs: {
                'danser': { ng: 'addan', radical: 'add', group: 1 },
                '√™tre': { ng: 'ess', radical: 'ess', group: 'irregular' },
                'finir': { ng: 'finar', radical: 'fin', group: 2 }
            },
            nouns: {
                'b√™te': { ng: 'gorval', gender_fr: 'f', gender_ng: 'm' }
            },
            others: {
                'le': { ng: 'skel', type: 'article' },
                'la': { ng: 'skel', type: 'article' },
                'et': { ng: 'y', type: 'conjonction' }
            }
        };
        
        // CONJUGAISONS FRAN√áAISES PAR GROUPE
        const frenchEndings = {
            group1: {
                pr√©sent: { je: 'e', tu: 'es', il: 'e', elle: 'e', nous: 'ons', vous: 'ez', ils: 'ent', elles: 'ent' },
                imparfait: { je: 'ais', tu: 'ais', il: 'ait', elle: 'ait', nous: 'ions', vous: 'iez', ils: 'aient', elles: 'aient' },
                futur: { je: 'erai', tu: 'eras', il: 'era', elle: 'era', nous: 'erons', vous: 'erez', ils: 'eront', elles: 'eront' }
            },
            group2: {
                pr√©sent: { je: 'is', tu: 'is', il: 'it', elle: 'it', nous: 'issons', vous: 'issez', ils: 'issent', elles: 'issent' },
                imparfait: { je: 'issais', tu: 'issais', il: 'issait', elle: 'issait', nous: 'issions', vous: 'issiez', ils: 'issaient', elles: 'issaient' },
                futur: { je: 'irai', tu: 'iras', il: 'ira', elle: 'ira', nous: 'irons', vous: 'irez', ils: 'iront', elles: 'iront' }
            },
            irregular: {
                '√™tre': {
                    pr√©sent: { je: 'suis', tu: 'es', il: 'est', elle: 'est', nous: 'sommes', vous: '√™tes', ils: 'sont', elles: 'sont' },
                    imparfait: { je: '√©tais', tu: '√©tais', il: '√©tait', elle: '√©tait', nous: '√©tions', vous: '√©tiez', ils: '√©taient', elles: '√©taient' },
                    futur: { je: 'serai', tu: 'seras', il: 'sera', elle: 'sera', nous: 'serons', vous: 'serez', ils: 'seront', elles: 'seront' }
                },
                'aller': {
                    pr√©sent: { je: 'vais', tu: 'vas', il: 'va', elle: 'va', nous: 'allons', vous: 'allez', ils: 'vont', elles: 'vont' },
                    imparfait: { je: 'allais', tu: 'allais', il: 'allait', elle: 'allait', nous: 'allions', vous: 'alliez', ils: 'allaient', elles: 'allaient' },
                    futur: { je: 'irai', tu: 'iras', il: 'ira', elle: 'ira', nous: 'irons', vous: 'irez', ils: 'iront', elles: 'iront' }
                }
            }
        };
        
        // CONJUGAISONS NILFGAARDIENNES
        const ngEndings = {
            pr√©sent: { je: 'en', tu: 'es', il: '', elle: '', nous: 'avam', vous: 'avel', ils: 'arin', elles: 'arin' },
            imparfait: { je: 'ien', tu: 'ias', il: 'ier', elle: 'ier', nous: 'iavem', vous: 'iavel', ils: 'iarn', elles: 'iarn' },
            futur: { je: 'rash', tu: 'resh', il: 'rin', elle: 'rin', nous: 'ravam', vous: 'ravel', ils: 'ranem', elles: 'ranim' }
        };
        
        let direction = 'fr-to-ng';
        
        // FONCTIONS PRINCIPALES
        function getSubject(words) {
            const pronouns = ['je', 'tu', 'il', 'elle', 'nous', 'vous', 'ils', 'elles'];
            for (const word of words) {
                if (pronouns.includes(word.toLowerCase())) {
                    return word.toLowerCase();
                }
            }
            return 'il';
        }
        
        // FONCTIONS DE CONJUGAISON
        function conjugateFrench(infinitive, person, tense = 'pr√©sent') {
            const verb = dict.verbs[infinitive];
            if (!verb) return infinitive;
            
            if (verb.group === 'irregular') {
                return frenchEndings.irregular[infinitive]?.[tense]?.[person] || infinitive;
            }
            
            const radical = infinitive.slice(0, -2); // Enlever -er ou -ir
            const groupKey = verb.group === 1 ? 'group1' : 'group2';
            const ending = frenchEndings[groupKey][tense][person];
            
            return radical + ending;
        }
        
        function conjugateNG(radical, person, tense = 'pr√©sent') {
            if ((person === 'il' || person === 'elle') && tense === 'pr√©sent') {
                return radical; // Infinitif pour il/elle au pr√©sent
            }
            
            const ending = ngEndings[tense][person];
            return radical + ending;
        }
        
        function translateFrToNg(text) {
            const words = text.toLowerCase().split(' ');
            const subject = getSubject(words);
            let result = [];
            let analysis = [];
            
            for (let i = 0; i < words.length; i++) {
                const word = words[i];
                let found = false;
                
                // D√©tecter futur proche (aller + infinitif)
                if (['vais', 'vas', 'va', 'allons', 'allez', 'vont'].includes(word) && i + 1 < words.length) {
                    const nextWord = words[i + 1];
                    const verb = dict.verbs[nextWord];
                    if (verb) {
                        result.push(`voor ${verb.ng}`);
                        analysis.push({
                            original: `${word} ${nextWord}`,
                            translation: `voor ${verb.ng}`,
                            type: 'futur proche'
                        });
                        i++; // Skip next word
                        found = true;
                        continue;
                    }
                }
                
                // Chercher les verbes conjugu√©s
                for (const [frVerb, verbData] of Object.entries(dict.verbs)) {
                    for (const tense of ['pr√©sent', 'imparfait', 'futur']) {
                        for (const person of ['je', 'tu', 'il', 'elle', 'nous', 'vous', 'ils', 'elles']) {
                            const conjugated = conjugateFrench(frVerb, person, tense);
                            if (conjugated === word) {
                                const ngForm = conjugateNG(verbData.radical, subject, tense);
                                result.push(ngForm);
                                analysis.push({
                                    original: word,
                                    translation: ngForm,
                                    type: `verbe (${subject}, ${tense})`
                                });
                                found = true;
                                break;
                            }
                        }
                        if (found) break;
                    }
                    if (found) break;
                }
                
                if (!found) {
                    // Chercher les noms
                    const noun = dict.nouns[word];
                    if (noun) {
                        result.push(noun.ng);
                        analysis.push({ original: word, translation: noun.ng, type: 'nom' });
                        found = true;
                    }
                }
                
                if (!found) {
                    // Chercher les autres mots
                    const other = dict.others[word];
                    if (other) {
                        result.push(other.ng);
                        analysis.push({ original: word, translation: other.ng, type: other.type });
                        found = true;
                    }
                }
                
                if (!found) {
                    result.push(`[${word}]`);
                    analysis.push({ original: word, translation: '[inconnu]', type: 'inconnu' });
                }
            }
            
            return { translation: result.join(' '), analysis, grammar: [`Sujet d√©tect√©: ${subject}`] };
        }
        
        function translateNgToFr(text) {
            const words = text.toLowerCase().split(' ');
            const subject = getSubject(words);
            let result = [];
            let analysis = [];
            
            for (let i = 0; i < words.length; i++) {
                const word = words[i];
                let found = false;
                
                // D√©tecter futur proche (voor + infinitif)
                if (word === 'voor' && i + 1 < words.length) {
                    const nextWord = words[i + 1];
                    for (const [frVerb, verbData] of Object.entries(dict.verbs)) {
                        if (verbData.ng === nextWord) {
                            const frForm = conjugateFrench('aller', subject, 'pr√©sent') + ' ' + frVerb;
                            result.push(frForm);
                            analysis.push({
                                original: `${word} ${nextWord}`,
                                translation: frForm,
                                type: 'futur proche'
                            });
                            found = true;
                            i++; // Skip next word
                            break;
                        }
                    }
                }
                
                if (!found) {
                    // Chercher les verbes conjugu√©s
                    for (const [frVerb, verbData] of Object.entries(dict.verbs)) {
                        for (const tense of ['pr√©sent', 'imparfait', 'futur']) {
                            for (const person of ['je', 'tu', 'il', 'elle', 'nous', 'vous', 'ils', 'elles']) {
                                const ngForm = conjugateNG(verbData.radical, person, tense);
                                if (ngForm === word) {
                                    const frForm = conjugateFrench(frVerb, subject, tense);
                                    result.push(frForm);
                                    analysis.push({
                                        original: word,
                                        translation: frForm,
                                        type: `verbe (${subject}, ${tense})`
                                    });
                                    found = true;
                                    break;
                                }
                            }
                            if (found) break;
                        }
                        if (found) break;
                    }
                }
                
                if (!found) {
                    // Chercher les noms
                    for (const [frNoun, nounData] of Object.entries(dict.nouns)) {
                        if (nounData.ng === word) {
                            result.push(frNoun);
                            analysis.push({ original: word, translation: frNoun, type: 'nom' });
                            found = true;
                            break;
                        }
                    }
                }
                
                if (!found) {
                    // Chercher les autres mots
                    for (const [frOther, otherData] of Object.entries(dict.others)) {
                        if (otherData.ng === word) {
                            result.push(frOther);
                            analysis.push({ original: word, translation: frOther, type: otherData.type });
                            found = true;
                            break;
                        }
                    }
                }
                
                if (!found) {
                    result.push(`[${word}]`);
                    analysis.push({ original: word, translation: '[inconnu]', type: 'inconnu' });
                }
            }
            
            return { translation: result.join(' '), analysis, grammar: [`Sujet d√©tect√©: ${subject}`] };
        }
        
        function translate() {
            const inputText = document.getElementById('input-text').value.trim();
            if (!inputText) {
                document.getElementById('output-text').value = '';
                document.getElementById('analysis').style.display = 'none';
                return;
            }
            
            let result;
            if (direction === 'fr-to-ng') {
                result = translateFrToNg(inputText);
            } else {
                result = translateNgToFr(inputText);
            }
            
            document.getElementById('output-text').value = result.translation;
            showAnalysis(result.analysis);
        }
        
        function swapLanguages() {
            const inputLabel = document.getElementById('input-label');
            const outputLabel = document.getElementById('output-label');
            const inputText = document.getElementById('input-text');
            const outputText = document.getElementById('output-text');
            
            // √âchanger les labels
            const tempLabel = inputLabel.textContent;
            inputLabel.textContent = outputLabel.textContent;
            outputLabel.textContent = tempLabel;
            
            // √âchanger les textes
            const tempText = inputText.value;
            inputText.value = outputText.value;
            outputText.value = tempText;
            
            // Changer la direction
            direction = direction === 'fr-to-ng' ? 'ng-to-fr' : 'fr-to-ng';
            
            // Retraduire
            translate();
        }
        
        function showAnalysis(analysisData) {
            const analysis = document.getElementById('analysis');
            const wordAnalysis = document.getElementById('word-analysis');
            
            wordAnalysis.innerHTML = '';
            analysisData.forEach(item => {
                const tag = document.createElement('div');
                tag.className = 'word-tag';
                tag.innerHTML = `<strong>${item.original}</strong> ‚Üí ${item.translation} <em>(${item.type})</em>`;
                wordAnalysis.appendChild(tag);
            });
            
            analysis.style.display = 'block';
        }
        
        // GESTION DES ONGLETS
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.style.display = 'none';
            });
            document.querySelectorAll('.dict-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName + '-tab').style.display = 'block';
            event.target.classList.add('active');
        }
        
        // AJOUT DE MOTS
        function addVerb() {
            const fr = document.getElementById('verb-fr').value.trim();
            const ng = document.getElementById('verb-ng').value.trim();
            const radical = document.getElementById('verb-radical').value.trim();
            const group = document.getElementById('verb-group').value;
            
            if (fr && ng && radical) {
                dict.verbs[fr] = { 
                    ng: ng, 
                    radical: radical, 
                    group: group === 'irregular' ? 'irregular' : parseInt(group) 
                };
                updateVerbsList();
                document.getElementById('verb-fr').value = '';
                document.getElementById('verb-ng').value = '';
                document.getElementById('verb-radical').value = '';
            }
        }
        
        function addNoun() {
            const fr = document.getElementById('noun-fr').value.trim();
            const ng = document.getElementById('noun-ng').value.trim();
            const genderFr = document.getElementById('noun-gender-fr').value;
            const genderNg = document.getElementById('noun-gender-ng').value;
            
            if (fr && ng) {
                dict.nouns[fr] = { ng: ng, gender_fr: genderFr, gender_ng: genderNg };
                updateNounsList();
                document.getElementById('noun-fr').value = '';
                document.getElementById('noun-ng').value = '';
            }
        }
        
        function addOther() {
            const fr = document.getElementById('other-fr').value.trim();
            const ng = document.getElementById('other-ng').value.trim();
            const type = document.getElementById('other-type').value;
            
            if (fr && ng) {
                dict.others[fr] = { ng: ng, type: type };
                updateOthersList();
                document.getElementById('other-fr').value = '';
                document.getElementById('other-ng').value = '';
            }
        }
        
        // MISE √Ä JOUR DES LISTES
        function updateVerbsList() {
            const list = document.getElementById('verbs-list');
            list.innerHTML = '';
            
            for (const [fr, data] of Object.entries(dict.verbs)) {
                const entry = document.createElement('div');
                entry.className = 'dict-entry';
                entry.innerHTML = `
                    <strong>${fr}</strong> ‚Üí ${data.ng} (radical: ${data.radical}) <em>Groupe ${data.group}</em>
                    <button class="remove-btn" onclick="removeVerb('${fr}')">√ó</button>
                `;
                list.appendChild(entry);
            }
        }
        
        function updateNounsList() {
            const list = document.getElementById('nouns-list');
            list.innerHTML = '';
            
            for (const [fr, data] of Object.entries(dict.nouns)) {
                const entry = document.createElement('div');
                entry.className = 'dict-entry';
                entry.innerHTML = `
                    <strong>${fr}</strong> (${data.gender_fr}) ‚Üí ${data.ng} (${data.gender_ng})
                    <button class="remove-btn" onclick="removeNoun('${fr}')">√ó</button>
                `;
                list.appendChild(entry);
            }
        }
        
        function updateOthersList() {
            const list = document.getElementById('others-list');
            list.innerHTML = '';
            
            for (const [fr, data] of Object.entries(dict.others)) {
                const entry = document.createElement('div');
                entry.className = 'dict-entry';
                entry.innerHTML = `
                    <strong>${fr}</strong> ‚Üí ${data.ng} <em>(${data.type})</em>
                    <button class="remove-btn" onclick="removeOther('${fr}')">√ó</button>
                `;
                list.appendChild(entry);
            }
        }
        
        // SUPPRESSION
        function removeVerb(fr) {
            delete dict.verbs[fr];
            updateVerbsList();
        }
        
        function removeNoun(fr) {
            delete dict.nouns[fr];
            updateNounsList();
        }
        
        function removeOther(fr) {
            delete dict.others[fr];
            updateOthersList();
        }
        
        // INITIALISATION
        function init() {
            updateVerbsList();
            updateNounsList();
            updateOthersList();
        }
        
        // √âV√âNEMENTS
        document.getElementById('input-text').addEventListener('input', function() {
            setTimeout(translate, 300);
        });
        
        window.onload = init;
    </script>
</body>
    </html>
