<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traducteur Fran√ßais ‚áÑ Nilfgaardien</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 1000px; margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px; padding: 30px;
        }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { color: #667eea; font-size: 2.5em; margin-bottom: 10px; }
        
        .translator {
            background: #f8f9fa; border-radius: 15px; padding: 25px; margin-bottom: 30px;
        }
        .translation-row {
            display: grid; grid-template-columns: 1fr auto 1fr; gap: 20px; align-items: center;
        }
        .translation-area label { font-weight: bold; margin-bottom: 10px; display: block; }
        .translation-area textarea { 
            width: 100%; height: 120px; border: 2px solid #e9ecef; 
            border-radius: 10px; padding: 15px; font-size: 16px; resize: none; 
        }
        .swap-btn { 
            background: linear-gradient(135deg, #ff6b6b, #feca57); 
            border: none; border-radius: 50%; width: 50px; height: 50px; 
            cursor: pointer; color: white; font-size: 20px;
        }
        
        .analysis { 
            background: #e3f2fd; border-radius: 10px; padding: 15px; margin-top: 20px;
        }
        .word-analysis { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
        .word-tag { 
            background: white; border: 1px solid #ddd; border-radius: 8px; 
            padding: 8px 12px; font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üó°Ô∏è Traducteur Fran√ßais ‚áÑ Nilfgaardien üó°Ô∏è</h1>
            <p>Syst√®me de traduction avec conjugaisons automatiques</p>
        </div>
        
        <div class="translator">
            <h2>üîÑ Traduction</h2>
            <div class="translation-row">
                <div class="translation-area">
                    <label id="input-label">Fran√ßais</label>
                    <textarea id="input-text" placeholder="Tapez votre texte ici..."></textarea>
                </div>
                
                <button class="swap-btn" onclick="swapLanguages()">‚áÑ</button>
                
                <div class="translation-area">
                    <label id="output-label">Nilfgaardien</label>
                    <textarea id="output-text" placeholder="La traduction appara√Ætra ici..." readonly></textarea>
                </div>
            </div>
        </div>
        
        <div class="analysis" id="analysis" style="display:none;">
            <h3>üìã Analyse de la traduction</h3>
            <div class="word-analysis" id="word-analysis"></div>
            <div id="grammar-notes" style="margin-top: 15px;"></div>
        </div>
    </div>

    <script>
        console.log("Script d√©marr√©");
        // DICTIONNAIRE ENRICHI
        const dict = {
            verbs: {
                'danser': { ng_conj: 'addan', ng_radical: 'add', ng_inf: 'addan', group: 1 },
                '√™tre': { ng_conj: 'ess', ng_radical: 'ess', ng_inf: 'essen', group: 'irregular' },
                'aller': { ng_conj: 'var', ng_radical: 'var', ng_inf: 'varen', group: 'irregular' },
                'avoir': { ng_conj: 'caerme', ng_radical: 'caer', ng_inf: 'caermen', group: 'irregular' },
                'finir': { ng_conj: 'finar', ng_radical: 'fin', ng_inf: 'finar', group: 2 },
                'choisir': { ng_conj: 'dewisan', ng_radical: 'dewis', ng_inf: 'dewisan', group: 2 },
                'manger': { ng_conj: 'kroesan', ng_radical: 'kroes', ng_inf: 'kroesan', group: 1 },
                'parler': { ng_conj: 'gwedan', ng_radical: 'gwed', ng_inf: 'gwedan', group: 1 },
                'faire': { ng_conj: 'gwneuden', ng_radical: 'gwneud', ng_inf: 'gwneuden', group: 'irregular' }
            },
            nouns: {
                'b√™te': { ng: 'gorval', gender_fr: 'f', gender_ng: 'm' },
                'chat': { ng: 'mithel', gender_fr: 'm', gender_ng: 'f' },
                'chien': { ng: 'ci', gender_fr: 'm', gender_ng: 'm' },
                'eau': { ng: 'v√πtter', gender_fr: 'f', gender_ng: 'f' },
                'homme': { ng: 'dyn', gender_fr: 'm', gender_ng: 'm' },
                'femme': { ng: 'dynes', gender_fr: 'f', gender_ng: 'f' },
                'cheval': { ng: 'ceffyl', gender_fr: 'm', gender_ng: 'm' },
                'maison': { ng: 't≈∑', gender_fr: 'f', gender_ng: 'm' }
            },
            adjectives: {
                'blanc': 'gwyn',
                'blanche': 'gwyn',
                'grand': 'mawr',
                'grande': 'mawr',
                'petit': 'bach',
                'petite': 'bach'
            },
            expressions: {
                'flamme blanche': { ng: 'deithwen', gender_fr: 'f', gender_ng: 'm' },
                'au revoir': { ng: 'va faill', gender_fr: 'm', gender_ng: 'm' }
            },
            others: {
                'le': { ng: '', type: 'article' },
                'la': { ng: '', type: 'article' },
                'les': { ng: '', type: 'article' },
                'je': { ng: '√©', type: 'pronom', show: true },
                'tu': { ng: 'ti', type: 'pronom', show: true },
                'il': { ng: 'ver', type: 'pronom', show: true },
                'elle': { ng: 'vara', type: 'pronom', show: true },
                'nous': { ng: 'ni', type: 'pronom', show: true },
                'vous': { ng: 'chi', type: 'pronom', show: true },
                'et': { ng: 'a', type: 'conjonction' }
            },
            irregularPlurals: {
                '≈ìil': 'yeux',
                'oeil': 'yeux',
                'cheval': 'chevaux'
            }
        };
        
        // CONJUGAISONS FRAN√áAISES COMPL√àTES
        const frenchConjugations = {
            group1: {
                pr√©sent: { je: 'e', tu: 'es', il: 'e', elle: 'e', nous: 'ons', vous: 'ez', ils: 'ent', elles: 'ent' },
                imparfait: { je: 'ais', tu: 'ais', il: 'ait', elle: 'ait', nous: 'ions', vous: 'iez', ils: 'aient', elles: 'aient' },
                futur: { je: 'erai', tu: 'eras', il: 'era', elle: 'era', nous: 'erons', vous: 'erez', ils: 'eront', elles: 'eront' }
            },
            group2: {
                pr√©sent: { je: 'is', tu: 'is', il: 'it', elle: 'it', nous: 'issons', vous: 'issez', ils: 'issent', elles: 'issent' },
                imparfait: { je: 'issais', tu: 'issais', il: 'issait', elle: 'issait', nous: 'issions', vous: 'issiez', ils: 'issaient', elles: 'issaient' },
                futur: { je: 'irai', tu: 'iras', il: 'ira', elle: 'ira', nous: 'irons', vous: 'irez', ils: 'iront', elles: 'iront' }
            },
            irregular: {
                '√™tre': {
                    pr√©sent: { je: 'suis', tu: 'es', il: 'est', elle: 'est', nous: 'sommes', vous: '√™tes', ils: 'sont', elles: 'sont' },
                    imparfait: { je: '√©tais', tu: '√©tais', il: '√©tait', elle: '√©tait', nous: '√©tions', vous: '√©tiez', ils: '√©taient', elles: '√©taient' },
                    futur: { je: 'serai', tu: 'seras', il: 'sera', elle: 'sera', nous: 'serons', vous: 'serez', ils: 'seront', elles: 'seront' }
                },
                'aller': {
                    pr√©sent: { je: 'vais', tu: 'vas', il: 'va', elle: 'va', nous: 'allons', vous: 'allez', ils: 'vont', elles: 'vont' },
                    imparfait: { je: 'allais', tu: 'allais', il: 'allait', elle: 'allait', nous: 'allions', vous: 'alliez', ils: 'allaient', elles: 'allaient' },
                    futur: { je: 'irai', tu: 'iras', il: 'ira', elle: 'ira', nous: 'irons', vous: 'irez', ils: 'iront', elles: 'iront' }
                },
                'avoir': {
                    pr√©sent: { je: 'ai', tu: 'as', il: 'a', elle: 'a', nous: 'avons', vous: 'avez', ils: 'ont', elles: 'ont' },
                    imparfait: { je: 'avais', tu: 'avais', il: 'avait', elle: 'avait', nous: 'avions', vous: 'aviez', ils: 'avaient', elles: 'avaient' },
                    futur: { je: 'aurai', tu: 'auras', il: 'aura', elle: 'aura', nous: 'aurons', vous: 'aurez', ils: 'auront', elles: 'auront' }
                },
                'faire': {
                    pr√©sent: { je: 'fais', tu: 'fais', il: 'fait', elle: 'fait', nous: 'faisons', vous: 'faites', ils: 'font', elles: 'font' },
                    imparfait: { je: 'faisais', tu: 'faisais', il: 'faisait', elle: 'faisait', nous: 'faisions', vous: 'faisiez', ils: 'faisaient', elles: 'faisaient' },
                    futur: { je: 'ferai', tu: 'feras', il: 'fera', elle: 'fera', nous: 'ferons', vous: 'ferez', ils: 'feront', elles: 'feront' }
                }
            }
        };
        
        // CONJUGAISONS NILFGAARDIENNES
        const ngConjugations = {
            pr√©sent: { je: 'en', tu: 'es', il: '', elle: '', nous: 'avam', vous: 'avel', ils: 'arin', elles: 'arin' },
            imparfait: { je: 'ien', tu: 'ias', il: 'ier', elle: 'ier', nous: 'iavem', vous: 'iavel', ils: 'iarn', elles: 'iarn' },
            futur: { je: 'rash', tu: 'resh', il: 'rin', elle: 'rin', nous: 'ravam', vous: 'ravel', ils: 'ranem', elles: 'ranim' }
        };
        
        let direction = 'fr-to-ng';
        // FONCTIONS DE PLURIEL
        function makeFrenchPlural(word) {
            if (dict.irregularPlurals[word.toLowerCase()]) {
                return dict.irregularPlurals[word.toLowerCase()];
            }
            
            if (word.endsWith('s') || word.endsWith('x') || word.endsWith('z')) return word;
            if (word.endsWith('eau')) return word + 'x';
            if (word.endsWith('al')) return word.slice(0, -2) + 'aux';
            if (word.endsWith('eu')) return word + 'x';
            
            return word + 's';
        }
        
        function makeNgPlural(word) {
            if (word.endsWith('n')) return word;
            if (word.endsWith('d')) return word + 'd';
            return word + 'n';
        }
        
        function detectFrenchPlural(word) {
            for (const [singular, plural] of Object.entries(dict.irregularPlurals)) {
                if (plural === word.toLowerCase()) {
                    return { singular: singular, isPlural: true };
                }
            }
            
            if (word.endsWith('s') || word.endsWith('x')) {
                let potential = word.slice(0, -1);
                if (dict.nouns[potential]) {
                    return { singular: potential, isPlural: true };
                }
                
                if (word.endsWith('aux')) {
                    potential = word.slice(0, -3) + 'al';
                    if (dict.nouns[potential]) {
                        return { singular: potential, isPlural: true };
                    }
                }
            }
            
            return { singular: word, isPlural: false };
        }
        
        function detectNgPlural(word) {
            if (word.endsWith('dd')) {
                const potential = word.slice(0, -1);
                for (const [frNoun, nounData] of Object.entries(dict.nouns)) {
                    if (nounData.ng === potential) {
                        return { singular: potential, isPlural: true, frSingular: frNoun };
                    }
                }
            }
            
            if (word.endsWith('n')) {
                const potential = word.slice(0, -1);
                for (const [frNoun, nounData] of Object.entries(dict.nouns)) {
                    if (nounData.ng === potential) {
                        return { singular: potential, isPlural: true, frSingular: frNoun };
                    }
                }
            }
            
            return { singular: word, isPlural: false };
        }
        
        // CONJUGAISONS
        function conjugateFrench(infinitive, person, tense = 'pr√©sent') {
            const verb = dict.verbs[infinitive];
            if (!verb) return infinitive;
            
            if (verb.group === 'irregular') {
                return frenchConjugations.irregular[infinitive]?.[tense]?.[person] || infinitive;
            }
            
            const radical = infinitive.slice(0, -2);
            const groupKey = verb.group === 1 ? 'group1' : 'group2';
            const ending = frenchConjugations[groupKey][tense][person];
            
            return radical + ending;
        }
        
        function conjugateNG(radical, person, tense = 'pr√©sent') {
            if ((person === 'il' || person === 'elle') && tense === 'pr√©sent') {
                return radical;
            }
            
            const ending = ngConjugations[tense]?.[person] || '';
            return radical + ending;
        }
        
        function detectSubject(words) {
            const pronouns = ['je', 'tu', 'il', 'elle', 'nous', 'vous', 'ils', 'elles'];
            for (const word of words) {
                if (pronouns.includes(word.toLowerCase())) {
                    return word.toLowerCase();
                }
            }
            
            // Chercher un nom pour d√©terminer le genre
            for (const word of words) {
                const noun = dict.nouns[word.toLowerCase()];
                if (noun) {
                    return noun.gender_fr === 'm' ? 'il' : 'elle';
                }
                
                // Chercher aussi dans les noms nilfgaardiens
                for (const [frNoun, nounData] of Object.entries(dict.nouns)) {
                    if (nounData.ng.toLowerCase() === word.toLowerCase()) {
                        return nounData.gender_ng === 'm' ? 'il' : 'elle';
                    }
                }
            }
            
            return 'il';
        }
        
        // TRADUCTIONS
        function translateFrToNg(text) {
            // Expressions compos√©es (traitement partiel)
            let textToProcess = text.toLowerCase();
            let expressionAnalysis = [];

            for (const [expr, data] of Object.entries(dict.expressions)) {
                const regex = new RegExp('\\b' + expr.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + '\\b', 'g');
                if (regex.test(textToProcess)) {
                    textToProcess = textToProcess.replace(regex, `|EXPR:${data.ng}|`);
                    expressionAnalysis.push({ original: expr, translation: data.ng, type: 'expression' });
                }
            }
            
            const words = textToProcess.split(' ');
            const subject = detectSubject(text.toLowerCase().split(' '));
            let result = [];
            let analysis = [...expressionAnalysis];
            
            for (let i = 0; i < words.length; i++) {
                let word = words[i];
                let found = false;
                
                // V√©rifier si c'est une expression remplac√©e
                if (word.startsWith('|EXPR:') && word.endsWith('|')) {
                    result.push(word.slice(6, -1));
                    found = true;
                }
                
                if (!found) {
                    // FUTUR PROCHE (aller + infinitif ‚Üí voor + infinitif)
                    if (['vais', 'vas', 'va', 'allons', 'allez', 'vont'].includes(word) && i + 1 < words.length) {
                        const nextWord = words[i + 1];
                        const verb = dict.verbs[nextWord];
                        if (verb) {
                            result.push(`voor ${verb.ng_radical}`);
                            analysis.push({
                                original: `${word} ${nextWord}`,
                                translation: `voor ${verb.ng_radical}`,
                                type: 'futur proche'
                            });
                            i++; // Passer au mot suivant
                            continue;
                        }
                    }
                    
                    // GESTION "DE + POSSESSIF" ‚Üí "AEP"
                    if (word === 'de' && i + 1 < words.length) {
                        const nextWord = words[i + 1];
                        if (['mon', 'ton', 'son', 'sa', 'ses', 'notre', 'votre', 'leur', 'leurs'].includes(nextWord)) {
                            result.push('aep');
                            analysis.push({
                                original: `${word} ${nextWord}`,
                                translation: 'aep',
                                type: 'de + possessif ‚Üí aep'
                            });
                            i++; // Passer au mot suivant
                            continue;
                        }
                    }
                    
                    // Verbes (avec tous les temps)
                    for (const [frVerb, verbData] of Object.entries(dict.verbs)) {
                        for (const tense of ['pr√©sent', 'imparfait', 'futur']) {
                            for (const person of ['je', 'tu', 'il', 'elle', 'nous', 'vous', 'ils', 'elles']) {
                                const conjugated = conjugateFrench(frVerb, person, tense);
                                if (conjugated === word) {
                                    const ngForm = conjugateNG(verbData.ng_radical, subject, tense);
                                    result.push(ngForm);
                                    analysis.push({ 
                                        original: word, 
                                        translation: ngForm, 
                                        type: `verbe (${subject}, ${tense})` 
                                    });
                                    found = true;
                                    break;
                                }
                            }
                            if (found) break;
                        }
                        if (found) break;
                    }
                    
                    if (!found) {
                        // Noms (singulier et pluriel)
                        const noun = dict.nouns[word];
                        if (noun) {
                            result.push(noun.ng);
                            analysis.push({ original: word, translation: noun.ng, type: 'nom (singulier)' });
                            found = true;
                        } else {
                            const pluralCheck = detectFrenchPlural(word);
                            if (pluralCheck.isPlural && dict.nouns[pluralCheck.singular]) {
                                const singularNoun = dict.nouns[pluralCheck.singular];
                                const ngPlural = makeNgPlural(singularNoun.ng);
                                result.push(ngPlural);
                                analysis.push({ 
                                    original: word, 
                                    translation: ngPlural, 
                                    type: 'nom (pluriel)' 
                                });
                                found = true;
                            }
                        }
                    }
                    
                    if (!found) {
                        // Adjectifs
                        const adj = dict.adjectives[word];
                        if (adj) {
                            result.push(adj);
                            analysis.push({ original: word, translation: adj, type: 'adjectif' });
                            found = true;
                        }
                    }
                    
                    if (!found) {
                        // Autres (incluant pronoms)
                        const other = dict.others[word];
                        if (other && (other.ng !== '' || other.show)) {
                            if (other.ng !== '') {
                                result.push(other.ng);
                                analysis.push({ original: word, translation: other.ng, type: other.type });
                            } else {
                                analysis.push({ original: word, translation: '[ignor√©]', type: other.type });
                            }
                            found = true;
                        }
                    }
                    
                    if (!found) {
                        result.push(`[${word}]`);
                        analysis.push({ original: word, translation: '[inconnu]', type: 'inconnu' });
                    }
                }
            }
            
            return {
                translation: result.join(' '),
                analysis: analysis,
                grammar: [`Sujet: ${subject}`]
            };
            function translateNgToFr(text) {
            // Expressions compos√©es (traitement partiel)
            let textToProcess = text.toLowerCase();
            let expressionAnalysis = [];

            for (const [frExpr, ngData] of Object.entries(dict.expressions)) {
                const regex = new RegExp('\\b' + ngData.ng.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') + '\\b', 'g');
                if (regex.test(textToProcess)) {
                    textToProcess = textToProcess.replace(regex, `|EXPR:${frExpr}|`);
                    expressionAnalysis.push({ original: ngData.ng, translation: frExpr, type: 'expression' });
                }
            }

            const words = textToProcess.split(' ');
            const subject = detectSubject(text.toLowerCase().split(' '));
            let result = [];
            let analysis = [...expressionAnalysis];

            for (let i = 0; i < words.length; i++) {
                let word = words[i];
                let found = false;
                
                // V√©rifier si c'est une expression remplac√©e
                if (word.startsWith('|EXPR:') && word.endsWith('|')) {
                    result.push(word.slice(6, -1));
                    found = true;
                }
                
                if (!found) {
                    // FUTUR PROCHE (voor + infinitif ‚Üí aller + infinitif)
                    if (word === 'voor' && i + 1 < words.length) {
                        const nextWord = words[i + 1];
                        // Chercher le verbe nilfgaardien correspondant
                        for (const [frVerb, verbData] of Object.entries(dict.verbs)) {
                            if (verbData.ng_radical === nextWord) {
                                const allerForm = conjugateFrench('aller', subject, 'pr√©sent');
                                result.push(`${allerForm} ${frVerb}`);
                                analysis.push({
                                    original: `${word} ${nextWord}`,
                                    translation: `${allerForm} ${frVerb}`,
                                    type: 'futur proche'
                                });
                                i++; // Passer au mot suivant
                                found = true;
                                break;
                            }
                        }
                        if (found) continue;
                    }
                    
                    // GESTION "AEP" ‚Üí Analyser le contexte pour "DE + POSSESSIF"
                    if (word === 'aep') {
                        // Pour l'instant, traduction simple bas√©e sur le sujet d√©tect√©
                        let possessif = 'de ses'; // Par d√©faut
                        
                        if (subject === 'je') possessif = 'de mes';
                        else if (subject === 'tu') possessif = 'de tes';
                        else if (subject === 'il' || subject === 'elle') possessif = 'de ses';
                        else if (subject === 'nous') possessif = 'de nos';
                        else if (subject === 'vous') possessif = 'de vos';
                        else if (subject === 'ils' || subject === 'elles') possessif = 'de leurs';
                        
                        // Analyser le mot suivant pour le genre/nombre si possible
                        if (i + 1 < words.length) {
                            const nextWord = words[i + 1];
                            console.log(`Analyse du mot apr√®s aep: ${nextWord}`);
                            
                            // V√©rifier si c'est un nom connu
                            for (const [frNoun, nounData] of Object.entries(dict.nouns)) {
                                if (nounData.ng === nextWord) {
                                    console.log(`Nom trouv√©: ${frNoun}, genre: ${nounData.gender_fr}`);
                                    // Ajuster selon le genre et nombre
                                    if (subject === 'il' || subject === 'elle') {
                                        if (nounData.gender_fr === 'm') {
                                            possessif = 'de son';
                                        } else {
                                            possessif = 'de sa';
                                        }
                                    }
                                    break;
                                }
                            }
                            
                            // V√©rifier si c'est un pluriel nilfgaardien
                            const pluralCheck = detectNgPlural(nextWord);
                            if (pluralCheck.isPlural) {
                                console.log(`Pluriel d√©tect√©: ${nextWord}`);
                                if (subject === 'il' || subject === 'elle') {
                                    possessif = 'de ses';
                                }
                            }
                        }
                        
                        result.push(possessif);
                        analysis.push({
                            original: word,
                            translation: possessif,
                            type: `aep ‚Üí ${possessif} (contexte: sujet ${subject})`
                        });
                        found = true;
                    }
                    
                    // Verbes conjugu√©s
                    for (const [frVerb, verbData] of Object.entries(dict.verbs)) {
                        for (const tense of ['pr√©sent', 'imparfait', 'futur']) {
                            for (const person of ['je', 'tu', 'il', 'elle', 'nous', 'vous', 'ils', 'elles']) {
                                const ngForm = conjugateNG(verbData.ng_radical, person, tense);
                                if (ngForm === word) {
                                    const frForm = conjugateFrench(frVerb, subject, tense);
                                    result.push(frForm);
                                    analysis.push({ 
                                        original: word, 
                                        translation: frForm, 
                                        type: `verbe (${subject}, ${tense})` 
                                    });
                                    found = true;
                                    break;
                                }
                            }
                            if (found) break;
                        }
                        if (found) break;
                    }
                    
                    if (!found) {
                        // Noms avec articles
                        for (const [frNoun, nounData] of Object.entries(dict.nouns)) {
                            if (nounData.ng === word) {
                                const article = nounData.gender_fr === 'm' ? 'le ' : 'la ';
                                result.push(article + frNoun);
                                analysis.push({ original: word, translation: article + frNoun, type: 'nom' });
                                found = true;
                                break;
                            }
                        }
                        
                        if (!found) {
                            // Pluriels NG
                            const pluralCheck = detectNgPlural(word);
                            if (pluralCheck.isPlural && pluralCheck.frSingular) {
                                const frPlural = makeFrenchPlural(pluralCheck.frSingular);
                                result.push('les ' + frPlural);
                                analysis.push({ 
                                    original: word, 
                                    translation: 'les ' + frPlural, 
                                    type: 'nom (pluriel)' 
                                });
                                found = true;
                            }
                        }
                    }
                    
                    if (!found) {
                        // Adjectifs
                        for (const [frAdj, ngAdj] of Object.entries(dict.adjectives)) {
                            if (ngAdj === word) {
                                result.push(frAdj);
                                analysis.push({ original: word, translation: frAdj, type: 'adjectif' });
                                found = true;
                                break;
                            }
                        }
                    }
                    
                    if (!found) {
                        // Autres (incluant pronoms)
                        const other = dict.others[word];
                        if (other && (other.ng !== '' || other.show)) {
                            if (other.ng !== '') {
                                result.push(other.ng);
                                analysis.push({ original: word, translation: other.ng, type: other.type });
                            } else {
                                analysis.push({ original: word, translation: '[ignor√©]', type: other.type });
                            }
                            found = true;
                        }
                    }
                    
                    if (!found) {
                        result.push(`[${word}]`);
                        analysis.push({ original: word, translation: '[inconnu]', type: 'inconnu' });
                    }
                }
            }
            
            return {
                translation: result.join(' '),
                analysis: analysis,
                grammar: [`Sujet: ${subject}`]
            };
        }
        
        // INTERFACE
        function translate() {
            console.log("Fonction translate appel√©e");
            
            const inputText = document.getElementById('input-text').value.trim();
            if (!inputText) {
                document.getElementById('output-text').value = '';
                document.getElementById('analysis').style.display = 'none';
                return;
            }
            
            let result;
            if (direction === 'fr-to-ng') {
                result = translateFrToNg(inputText);
            } else {
                result = translateNgToFr(inputText);
            }
            
            document.getElementById('output-text').value = result.translation;
            showAnalysis(result.analysis, result.grammar);
        }
        
        function swapLanguages() {
            const inputLabel = document.getElementById('input-label');
            const outputLabel = document.getElementById('output-label');
            const inputText = document.getElementById('input-text');
            const outputText = document.getElementById('output-text');
            
            const tempLabel = inputLabel.textContent;
            inputLabel.textContent = outputLabel.textContent;
            outputLabel.textContent = tempLabel;
            
            const tempText = inputText.value;
            inputText.value = outputText.value;
            outputText.value = tempText;
            
            direction = direction === 'fr-to-ng' ? 'ng-to-fr' : 'fr-to-ng';
            translate();
        }
        
        function showAnalysis(analysisData, grammarNotes) {
            const analysis = document.getElementById('analysis');
            const wordAnalysis = document.getElementById('word-analysis');
            const grammarDiv = document.getElementById('grammar-notes');
            
            wordAnalysis.innerHTML = '';
            analysisData.forEach(item => {
                const tag = document.createElement('div');
                tag.className = 'word-tag';
                tag.innerHTML = `<strong>${item.original}</strong> ‚Üí ${item.translation} <em>(${item.type})</em>`;
                wordAnalysis.appendChild(tag);
            });
            
            grammarDiv.innerHTML = grammarNotes.map(note => `<div>üìù ${note}</div>`).join('');
            analysis.style.display = 'block';
        }
        
        // √âV√âNEMENTS
        document.getElementById('input-text').addEventListener('input', function() {
            setTimeout(translate, 300);
        });
        
        window.onload = function() {
            console.log("Page charg√©e");
        };
        
        console.log("Script termin√©");
    </script>
</body>
</html>
